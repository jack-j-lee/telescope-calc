# Cloud deployment: single-host behind Nginx reverse proxy.
# Run: docker compose -f docker-compose.cloud.yml up -d
# App: http://localhost (or your host). API at /v1, /health.
# Optional: copy env.example to .env and set CORS_ORIGINS / NEXT_PUBLIC_API_BASE.

services:
  backend:
    build: ./backend
    environment:
      - CORS_ORIGINS=${CORS_ORIGINS:-*}
    restart: unless-stopped

  frontend:
    build:
      context: ./frontend
      args:
        NEXT_PUBLIC_API_BASE=${NEXT_PUBLIC_API_BASE:-}
    restart: unless-stopped

  nginx:
    image: nginx:alpine
    ports:
      - "80:80"
    volumes:
      - ./nginx/nginx.conf:/etc/nginx/conf.d/default.conf:ro
    depends_on:
      - backend
      - frontend
    restart: unless-stopped
